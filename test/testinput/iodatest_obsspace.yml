---
window_begin: "2018-04-14T21:00:00Z"
window_end: "2018-04-15T03:00:00Z"
Variables:
   nvars: 1
   variables:
   - "testvar"
Locations:
  lats:
  - 45.0
  - 40.0
  lons:
  - 0.0
  - -100.0
Observations:
  _: &localization
    distance: 3.35e6
    max_nobs: -1
    searchMethod: "brute_force"
    lonRefPoint: 0.
    latRefPoint: 90.
  ObsTypes:
  - ObsSpace:
      name: "Aod"
      simulate:
      ObsDataIn:
        obsfile: "Data/aod_obs_2018041500_m.nc4"
      Localization: *localization
      TestData:
        nlocs: 100
        nrecs: 100
        nlocs_local: 11
        nvars: 1
        groups:
          - "MetaData"
          - "MetaData"
        variables:
          - "latitude"
          - "longitude"
        norms:
          - 353.11505923005967
          - 1981.4147543887036
        tolerance:
          - 1.0e-14

  - ObsSpace:
      name: "Radiance"
      simulate:
      ObsDataIn:
        obsfile: "Data/amsua_n19_obs_2018041500_m.nc4"
      Localization: *localization
      TestData:
        nlocs: 100
        nlocs_local: 10
        nrecs: 100
        nvars: 15
        groups:
          - "MetaData"
          - "MetaData"
        variables:
          - "latitude"
          - "longitude"
        norms:
          - 432.95617402805823
          - 1661.1529210392009
        tolerance:
          - 1.0e-11

  - ObsSpace:
      name: "Radiance"
      simulate:
      ObsDataIn:
        obsfile: "Data/smap_obs_2018041500_m.nc4"
      Localization: *localization
      TestData:
        nlocs: 45
        nlocs_local: 0
        nrecs: 45
        nvars: 4
        groups:
          - "MetaData"
          - "MetaData"
        variables:
          - "latitude"
          - "longitude"
        norms:
          - 558.238937361
          - 137.162692422
        tolerance:
          - 1.0e-11

  - ObsSpace:
      name: "Radiance"
      simulate:
      ObsDataIn:
        obsfile: "Data/gmi_gpm_obs_2018041500_m.nc4"
      Localization: *localization
      TestData:
        nlocs: 12
        nlocs_local: 0
        nrecs: 12
        nvars: 13
        groups:
          - "MetaData"
          - "MetaData"
        variables:
          - "latitude"
          - "longitude"
        norms:
          - 211.00380053756118
          - 172.29837728971688
        tolerance:
          - 1.0e-11

  - ObsSpace:
      name: "Radiosonde"
      simulate:
      ObsDataIn:
        obsfile: "Data/sondes_obs_2018041500_m.nc4"
      Localization: *localization
      TestData:
        nlocs: 974
        nlocs_local: 110
        nrecs: 974
        nvars: 5
        groups:
          - "MetaData"
          - "MetaData"
        variables:
          - "latitude"
          - "longitude"
        norms:
          - 1254.66336565038
          - 6076.2659622388919
        tolerance:
          - 1.0e-11
      ObsDataOut:
        obsfile: "testoutput/diagout.nc4"

  - ObsSpace:
      name: "Synthetic"
      simulate:
        variables: [air_temperature, eastward_wind]
      Generate:
        nobs: 10   # generate 10 obs
        lat1: 0    # with lat ranging form 0-10.
        lat2: 10   #
        lon1: 0    # and lon ranging from 0-10.
        lon2: 10
        random_seed: 29837
        obs_errors: [1.0, 2.0]
      Localization: *localization
      TestData:
        nlocs: 10
        nlocs_local: 0
        nrecs: 10
        nvars: 2
        groups:
          - "MetaData"
          - "MetaData"
          - "ObsError"
          - "ObsError"
        variables:
          - "latitude"
          - "longitude"
          - "air_temperature"
          - "eastward_wind"
        norms:
          - 20.349321770437683
          - 21.063312039377447
          - 3.1622776601683795
          - 6.32455532034
        tolerance:
          - 1.0e-11
      ObsDataOut:
        obsfile: "testoutput/ospace.generate.nc4"

  - ObsSpace:
      name: "Radiosonde with grouping"
      simulate:
      ObsDataIn:
        obsfile: "Data/sondes_obs_2018041500_m.nc4"
        obsgrouping:
          group_variable: "station_id"
          sort_variable: "air_pressure"
          sort_order: "descending"
      Localization: *localization
      TestData:
        nlocs: 974
        nlocs_local: 110
        nrecs: 36
        nvars: 5
        groups:
          - "MetaData"
          - "MetaData"
        variables:
          - "latitude"
          - "longitude"
        norms:
          - 1254.66336565038
          - 6076.2659622388919
        tolerance:
          - 1.0e-11
      ObsDataOut:
        obsfile: "testoutput/diagout_with_groups.nc4"

  - ObsSpace:
      name: "Radiosonde with grouping and tw filtering"
      simulate:
      ObsDataIn:
        obsfile: "Data/sondes_obs_2018041500_m_twfilt.nc4"
        obsgrouping:
          group_variable: "station_id"
      Localization: *localization
      TestData:
        nlocs: 968
        nlocs_local: 109
        nrecs: 31
        nvars: 5
        groups:
          - "MetaData"
          - "MetaData"
        variables:
          - "latitude"
          - "longitude"
        norms:
          - 1252.0139923322768
          - 6065.3117664336605
        tolerance:
          - 1.0e-11
      ObsDataOut:
        obsfile: "testoutput/diagout_with_groups_twfilt.nc4"
